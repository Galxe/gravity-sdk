# Gravity Cluster Configuration
# Copy this file to cluster.toml and modify as needed

[cluster]
name = "gravity-devnet"
# Base directory for all node data (each node gets a subdirectory)
base_dir = "/tmp/gravity-cluster"


[build]
# Path to gravity_node binary
binary_path = "../target/quick-release/gravity_node"

# External dependencies configuration
[dependencies.genesis_contracts]
# Git repository URL for gravity_chain_core_contracts
repo = "https://github.com/Galxe/gravity_chain_core_contracts.git"
# Git ref (branch, tag, or commit hash) to checkout
# Use "main" for latest, or specific commit hash for reproducibility
ref = "main"

[dependencies.gravity_bench]
repo = "https://github.com/Galxe/gravity_bench.git"
ref = "main"

# Node definitions
# Each node requires: id, host, and ports
# Role types:
#   - "genesis": Included in initial validator set in genesis.json
#   - "validator": Validator node but NOT in initial genesis (can join later)
#   - "vfn": Full node, uses onchain discovery

# ============ Genesis Nodes (node1-node4) ============

[[nodes]]
id = "node1"
host = "127.0.0.1"
role = "genesis"
p2p_port = 6180
vfn_port = 6190
rpc_port = 8545
metrics_port = 9001
inspection_port = 10000
https_port = 1024
authrpc_port = 8551
reth_p2p_port = 12024

[[nodes]]
id = "node2"
host = "127.0.0.1"
role = "genesis"
p2p_port = 6181
vfn_port = 6191
rpc_port = 8546
metrics_port = 9002
inspection_port = 10001
https_port = 1025
authrpc_port = 8552
reth_p2p_port = 12025

[[nodes]]
id = "node3"
host = "127.0.0.1"
role = "genesis"
p2p_port = 6182
vfn_port = 6192
rpc_port = 8547
metrics_port = 9003
inspection_port = 10002
https_port = 1026
authrpc_port = 8553
reth_p2p_port = 12026

[[nodes]]
id = "node4"
host = "127.0.0.1"
role = "genesis"
p2p_port = 6183
vfn_port = 6193
rpc_port = 8548
metrics_port = 9004
inspection_port = 10003
https_port = 1027
authrpc_port = 8554
reth_p2p_port = 12027

# ============ Validator Nodes (node5) ============

[[nodes]]
id = "node5"
host = "127.0.0.1"
role = "validator"
p2p_port = 6184
vfn_port = 6194
rpc_port = 8549
metrics_port = 9005
inspection_port = 10004
https_port = 1028
authrpc_port = 8565
reth_p2p_port = 12028

# ============ Full Nodes (vfn1) ============

[[nodes]]
id = "vfn1"
host = "127.0.0.1"
role = "vfn"
vfn_port = 6195
rpc_port = 8550
metrics_port = 9006
inspection_port = 10005
https_port = 1029
authrpc_port = 8566
reth_p2p_port = 12029

# Genesis configuration
# These values are used when generating the genesis.json
[genesis]
epoch_interval_micros = 7200000000  # 2 hours in microseconds
major_version = 1
# The consensus_config bytes are BCS-serialized from the following Rust struct:
# V4 { alg: JolteonV2 { main: ConsensusConfigV1 { decoupled_execution: true,
# back_pressure_limit: 10, exclude_round: 40, proposer_election_type:
# RotatingProposer(1), max_failed_authors_to_store: 10 }, quorum_store_enabled:
# true, order_vote_enabled: false }, vtxn: V1 { per_block_limit_txn_count: 2,
# per_block_limit_total_bytes: 2097152 }, window_size: None }
consensus_config = "0x0301010a00000000000000280000000000000001010000000a000000000000000100010200000000000000000020000000000000"
execution_config = "0x00"

[genesis.validator_config]
minimum_bond = "1000000000000000000"
maximum_bond = "1000000000000000000000000"
unbonding_delay_micros = 604800000000
allow_validator_set_change = true
voting_power_increase_limit_pct = 20
max_validator_set_size = "100"

[genesis.staking_config]
minimum_stake = "1000000000000000000"
lockup_duration_micros = 86400000000
unbonding_delay_micros = 86400000000
minimum_proposal_stake = "10000000000000000000"

[genesis.governance_config]
min_voting_threshold = "1000000000000000000"
required_proposer_stake = "10000000000000000000"
voting_duration_micros = 604800000000

[genesis.randomness_config]
variant = 1
secrecy_threshold = 9223372036854775808
reconstruction_threshold = 12297829382473033728
fast_path_secrecy_threshold = 12297829382473033728

[genesis.oracle_config]
source_types = [1]
callbacks = ["0x00000000000000000000000000000001625F4001"]

[genesis.oracle_config.bridge_config]
deploy = true
trusted_bridge = "0xcbEAF3BDe82155F56486Fb5a1072cb8baAf547cc"

[[genesis.oracle_config.tasks]]
source_type = 0
source_id = 11155111
task_name = "sepolia"
config = "gravity://0/11155111/events?contract=0x0f761B1B3c1aC9232C9015A7276692560aD6a05F&eventSignature=0x5646e682c7d994bf11f5a2c8addb60d03c83cda3b65025a826346589df43406e&fromBlock=10201260"

# JWK config - Google OIDC provider
[genesis.jwk_config]
issuers = ["0x68747470733a2f2f6163636f756e74732e676f6f676c652e636f6d"]

[[genesis.jwk_config.jwks]]
kid = "f5f4c0ae6e6090a65ab0a694d6ba6f19d5d0b4e6"
kty = "RSA"
alg = "RS256"
e = "AQAB"
n = "2K7epoJWl_aBoYGpXmDBBiEnwQ0QdVRU1gsbGXNrEbrZEQdY5KjH5P5gZMq3d3KvT1j5KsD2tF_9jFMDLqV4VWDNJRLgSNJxhJuO_oLO2BXUSL9a7fLHxnZCUfJvT2K-O8AXjT3_ZM8UuL8d4jBn_fZLzdEI4MHrZLVSaHDvvKqL_mExQo6cFD-qyLZ-T6aHv2x8R7L_3X7E1nGMjKVVZMveQ_HMeXvnGxKf5yfEP0hIQlC_kFm4L_1kV1S0UPmMptZL2qI4VnXqmqI6TZJyE-3VXHgNn1Z1O_9QZlPC0fF0spLHf2S3nNqI0v3k2E7q3DkqxVf5xvn7q_X-gPqzVE9Jw"

[faucet_init]
num_accounts = 0 # Set to > 0 to enable auto-initialization
private_key = "0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80"
eth_balance = "1000000000000000000"
